    /*    ** server.c -- serveur daytime demonstration    ** a faire : ajouter la gestion des erreurs    ** a faire : faire le traitement pour le fils dans un fork    */    #include <stdio.h>    #include <stdlib.h>    #include <unistd.h>    #include <errno.h>    #include <string.h>    #include <sys/types.h>    #include <sys/socket.h>    #include <sys/time.h>    #include <time.h>    #include <netinet/in.h>    #include <arpa/inet.h>    #define MYPORT 3490    // Port du point de connexion    //#define BACKLOG 10     // Combien de connexion en attente autorise-t-on ?    //#define MAXDATASIZE 100 // Nombre maximal d'octer a envoyer en une fois	#define BUFFERSIZE 500 // Taille du buffer		//char buffer[250];    int main(int argc, char argv[])    {        int sock_fd;  // sock_fd : point de connexion        struct sockaddr_in serv_addr;    // adresse de transport (adresse du serveur)		int addrlen;		char buffer[BUFFERSIZE];				//char input_addr[150] = "127.0.0.1";				/*        struct sockaddr_in my_addr;    // adresse de transport de la socket coté serveur        struct sockaddr_in their_addr; // adresse de transport de la socket coté client        int sin_size; // Taille d'une adresse de transport        int yes = 1;        char* date_string; // Chaine de caractere contenant la date        struct timeval time_value;		*/				if(argc == 2) { // Si il y a eu un paramètre entré (argv[0] = commande et argv[1] = IP (argument 1)									// Creation et initialisation du point de connexion			//socket()			sock_fd = socket(AF_INET, SOCK_STREAM, 0);					if(sock_fd == -1)				perror("[ERR] Creation du pt de con. (socket) : ");        			// Configuration de l'adresse de transport			serv_addr.sin_family = AF_INET;         // type de la socket			serv_addr.sin_port = htons(MYPORT);     // port, converti en reseau			serv_addr.sin_addr.s_addr = inet_addr(input_addr/*(const char*)argv[1]*/); // adresse, convertie en int [PAS DE conversion réseau nécessaire]			//serv_addr.sin_addr.s_addr = gethostbyname(input_addr); // adresse, convertie en int [PAS DE conversion réseau nécessaire]			bzero(&(serv_addr.sin_zero), 8);        // mise a zero du reste de la structure						if(serv_addr.sin_addr.s_addr == INADDR_NONE) {				printf("[ERR] Adresse IP invalide");			}						else {							addrlen = sizeof(serv_addr);							//connect()				if(connect(sock_fd, (struct sockaddr*)&serv_addr, addrlen) == -1)						perror("[ERR] Connexion (connect) : ");				// On envoie la chaîne				if(send(new_fd, argv[1], strlen(argv[1]), 0) == -1)					perror("[ERR] Envoi de la date/heure (send) : ");							//receive()				if(recv(sock_fd, &buffer, BUFFERSIZE, 0) == -1)						perror("[ERR] Réception (recv) : ");							//close()				if(close(sock_fd) == -1)						perror("[ERR] Fermeture de la socket (close) : ");							//display				strcat(buffer,"\0 ");				printf("%s \n", buffer);						}					}				else {						printf("[ERR] Aucune adresse IP spécifiée");					}        return 0;    }